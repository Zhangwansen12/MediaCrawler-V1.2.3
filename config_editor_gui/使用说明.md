# MediaCrawler 配置编辑器使用说明

## 📖 概述

MediaCrawler 配置编辑器是一个可视化的配置文件编辑工具，为 MediaCrawler 项目提供图形化的配置管理界面。用户无需手动编辑 Python 配置文件，即可通过直观的图形界面完成所有配置操作。

## 🎯 主要功能

### ✨ 核心特性
- **可视化编辑**: 提供直观的图形界面，告别手动编辑配置文件
- **多文件支持**: 支持编辑所有平台的配置文件
- **实时验证**: 配置项输入时进行实时验证，防止错误配置
- **类型智能识别**: 自动识别配置项类型并提供相应的编辑控件
- **安全保存**: 自动备份原配置文件，确保配置安全
- **导入导出**: 支持配置的导入和导出功能

### 🔧 支持的配置类型
- **布尔值**: 复选框控件
- **选择项**: 下拉菜单（如平台选择、登录类型等）
- **整数**: 数字输入框（如端口号、数量限制等）
- **密码**: 密码输入框（如数据库密码、代理密码等）
- **文件路径**: 文件选择对话框
- **文本**: 单行/多行文本框
- **列表**: 可编辑列表（如关键词列表、ID列表等）
- **字典**: 键值对编辑

## 📁 文件结构

```
config_editor_gui/
├── __init__.py              # 包初始化文件
├── config_editor.py         # 配置编辑器核心实现
├── test_config_editor.py    # 功能测试脚本
├── 使用说明.md              # 本文档
└── README.md               # 文件夹说明
```

## 🚀 快速开始

### 方法一：通过主GUI界面使用（推荐）

1. **启动主GUI应用**:
   ```bash
   # 在 MediaCrawler 根目录下执行
   python gui_app.py
   
   # 或使用批处理文件
   start_gui.bat    # Windows
   ./start_gui.sh   # Linux/macOS
   ```

2. **打开配置编辑器**:
   - 在主界面找到"配置管理"按钮
   - 点击按钮打开配置编辑器窗口

### 方法二：独立运行测试

1. **运行测试脚本**:
   ```bash
   # 在 MediaCrawler 根目录下执行
   python config_editor_gui/test_config_editor.py
   ```

2. **测试功能**:
   - 点击"打开配置编辑器"按钮
   - 点击"检查配置文件"验证文件存在性

## 📋 详细使用指南

### 1. 启动配置编辑器

配置编辑器可以通过以下方式启动：

#### 从主GUI界面启动（推荐）
- 启动 `gui_app.py`
- 在"爬虫功能区"找到"配置管理"按钮
- 点击按钮即可打开配置编辑器

#### 独立测试启动
- 运行 `config_editor_gui/test_config_editor.py`
- 在测试界面点击"打开配置编辑器"

### 2. 选择配置文件

配置编辑器启动后，会显示配置文件选择界面：

1. **文件列表**: 显示所有可编辑的配置文件
   - `base_config.py` - 基础配置
   - `dy_config.py` - 抖音平台配置
   - `xhs_config.py` - 小红书平台配置
   - `bilibili_config.py` - B站平台配置
   - `weibo_config.py` - 微博平台配置
   - `zhihu_config.py` - 知乎平台配置
   - `ks_config.py` - 快手平台配置
   - `tieba_config.py` - 贴吧平台配置
   - `db_config.py` - 数据库配置

2. **选择文件**: 双击文件名或选中后点击"编辑"按钮

### 3. 编辑配置项

进入配置编辑界面后，您将看到：

#### 界面布局
- **左侧**: 配置项列表和编辑区域
- **右侧**: 操作按钮区域
- **底部**: 状态栏显示当前操作状态

#### 配置项类型及操作

**布尔值配置**
- 显示为复选框
- 勾选表示 `True`，不勾选表示 `False`
- 例如：`HEADLESS`（无头模式）、`ENABLE_IP_PROXY`（启用代理）

**选择项配置**
- 显示为下拉菜单
- 从预定义选项中选择
- 例如：`PLATFORM`（平台选择）、`LOGIN_TYPE`（登录类型）

**数字配置**
- 显示为数字输入框
- 支持整数输入和验证
- 例如：`CRAWLER_MAX_NOTES_COUNT`（最大采集数量）

**文本配置**
- 单行文本：显示为文本输入框
- 多行文本：显示为文本区域
- 例如：`KEYWORDS`（关键词）、`COOKIES`（Cookie信息）

**密码配置**
- 显示为密码输入框（内容被遮蔽）
- 例如：数据库密码、代理密码

**文件路径配置**
- 显示为文件路径输入框 + 浏览按钮
- 点击浏览按钮选择文件
- 例如：`SQLITE_DB_PATH`（SQLite数据库路径）

**列表配置**
- 显示为可编辑列表
- 支持添加、删除、修改列表项
- 例如：`DY_SPECIFIED_ID_LIST`（指定用户ID列表）

**字典配置**
- 显示为键值对编辑器
- 支持添加、删除、修改键值对
- 例如：代理配置字典

### 4. 保存配置

完成配置编辑后：

1. **验证配置**: 系统会自动验证配置项的有效性
2. **保存配置**: 点击"保存配置"按钮
3. **备份机制**: 系统会自动备份原配置文件（添加 `.backup` 后缀）
4. **确认保存**: 显示保存成功提示

### 5. 其他功能

#### 重置配置
- 点击"重置"按钮恢复到文件原始状态
- 会弹出确认对话框防止误操作

#### 导入配置
- 点击"导入"按钮从其他配置文件导入设置
- 支持 JSON 格式的配置文件

#### 导出配置
- 点击"导出"按钮将当前配置导出为 JSON 文件
- 便于配置的备份和分享

## ⚙️ 配置项详解

### 基础配置 (base_config.py)

| 配置项 | 类型 | 说明 | 示例值 |
|--------|------|------|--------|
| `PLATFORM` | 选择项 | 爬取平台 | `xhs`, `dy`, `bilibili` |
| `KEYWORDS` | 文本 | 搜索关键词 | `美食,旅游,摄影` |
| `LOGIN_TYPE` | 选择项 | 登录方式 | `qrcode`, `phone`, `cookie` |
| `CRAWLER_TYPE` | 选择项 | 爬取类型 | `search`, `detail`, `creator` |
| `CRAWLER_MAX_NOTES_COUNT` | 整数 | 最大爬取数量 | `20` |
| `HEADLESS` | 布尔值 | 无头模式 | `True`/`False` |
| `ENABLE_IP_PROXY` | 布尔值 | 启用IP代理 | `True`/`False` |

### 平台特定配置

每个平台都有其特定的配置项：

**抖音配置 (dy_config.py)**
- `DY_SPECIFIED_ID_LIST`: 指定用户ID列表
- `DY_CREATOR_ID_LIST`: 创作者ID列表
- `PUBLISH_TIME_TYPE`: 发布时间类型

**小红书配置 (xhs_config.py)**
- `XHS_SPECIFIED_NOTE_URL_LIST`: 指定笔记URL列表
- `XHS_CREATOR_ID_LIST`: 创作者ID列表
- `SORT_TYPE`: 排序类型

### 数据库配置 (db_config.py)

| 配置项 | 类型 | 说明 |
|--------|------|------|
| `MYSQL_HOST` | 文本 | MySQL主机地址 |
| `MYSQL_PORT` | 整数 | MySQL端口 |
| `MYSQL_USER` | 文本 | MySQL用户名 |
| `MYSQL_PASSWORD` | 密码 | MySQL密码 |
| `MYSQL_DB` | 文本 | MySQL数据库名 |
| `SQLITE_DB_PATH` | 文件路径 | SQLite数据库路径 |

## 🔧 技术实现

### 核心类：ConfigEditor

```python
class ConfigEditor:
    """配置编辑器主类"""
    
    def __init__(self, parent):
        """初始化配置编辑器"""
        
    def open_config_editor(self):
        """打开配置编辑器窗口"""
        
    def load_config_file(self, file_path):
        """加载配置文件"""
        
    def save_config(self):
        """保存配置到文件"""
        
    def validate_config(self):
        """验证配置项有效性"""
```

### 配置项类型识别

系统通过以下规则自动识别配置项类型：

1. **布尔值**: 值为 `True` 或 `False`
2. **选择项**: 变量名包含特定关键词（如 `TYPE`, `MODE`）
3. **整数**: 值为数字类型
4. **密码**: 变量名包含 `PASSWORD` 或 `PASSWD`
5. **文件路径**: 变量名包含 `PATH` 或 `FILE`
6. **列表**: 值为列表类型
7. **字典**: 值为字典类型

## 🛠️ 故障排除

### 常见问题

**1. 配置编辑器无法启动**
- 检查是否在 MediaCrawler 根目录下运行
- 确认 `tkinter` 库已正确安装
- 检查 Python 版本（推荐 3.11+）

**2. 配置文件加载失败**
- 确认配置文件存在且格式正确
- 检查文件权限是否允许读取
- 查看错误日志获取详细信息

**3. 配置保存失败**
- 检查文件写入权限
- 确认磁盘空间充足
- 验证配置项格式是否正确

**4. 配置项显示异常**
- 检查配置文件语法是否正确
- 确认变量名和值的格式
- 重启配置编辑器重新加载

### 调试模式

启用调试模式查看详细日志：

```python
# 在 config_editor.py 中设置
DEBUG = True
```

## 📞 技术支持

如果您在使用过程中遇到问题：

1. **查看日志**: 检查控制台输出的错误信息
2. **重启应用**: 尝试重启配置编辑器
3. **检查文件**: 确认配置文件格式正确
4. **恢复备份**: 如有问题可恢复 `.backup` 文件

## 🔄 版本更新

### v1.0.0 (当前版本)
- ✅ 基础配置编辑功能
- ✅ 多种配置项类型支持
- ✅ 实时验证和错误处理
- ✅ 配置导入导出功能
- ✅ 自动备份机制

### 未来计划
- 🔄 配置模板功能
- 🔄 批量配置操作
- 🔄 配置历史记录
- 🔄 更多平台支持

---

**注意**: 本配置编辑器是 MediaCrawler 项目的重要组成部分，请确保在使用前已正确安装和配置 MediaCrawler 主程序。